================================================================================
To compile UCGretina

  $ source <G4INSTALL>/share/Geant4-9.6.1/geant4make/geant4make.sh
  $ make

Here, the file env.sh comes from your local installation of geant4. 

To use the liquid hydrogen target:

  $ make LHTARGET=1

produces the binary UCGretina_LH

================================================================================
To simulate the response of the array to a gamma ray

  Run a macro file like "test.mac" describing the measurement.

  $ UCGretina test.mac > test.log

  The last part --  "> test.log"  -- is optional, but it's a good
  idea. It saves the text messages from UCGretina in a log file.

UCGretina reads the description of the beam, reaction and gamma ray
from the macro file ("test.mac", e.g.). It writes the detector number,
energy deposited, and hit position of each gamma-ray interaction with
an active detector volume in ascii format to an output file (name
specified in the macro file).

The output file test.out contains gamma-ray tracking information for
each event that deposited energy in GRETINA. For each event there is a
header line beginning with '$':

   $ nHits Egamma Event#

where nHits is the number of hits, Egamma is the total energy of the
gamma ray, and Event# is the event number. The header line is followed
by nHits lines describing the hits with the format:

   detNum Edep x y z

where Edep is the energy (in keV) deposited in crystal detNum
by the hit. The hit positions (x, y, z) are in mm. 

================================================================================
Selected Commands

Optional commands for setting target/source parameters:

  /Target/Material
  /Target/X_length 
  /Target/Y_length
  /Target/SetPosition_Z
  /Target/Thickness
  /Target/ScaleDensity
  /Target/sourceFrame
  /Target/Sled 

Mandatory command for building a target/source frame:

  /Target/Construct

Optional commands for setting beam-tube parameters:

  /BeamTube/R_min
  /BeamTube/R_max
  /BeamTube/Length

Mandatory command for building the beam tube:

  /BeamTube/Construct

Optional commands for setting GRETINA parameters:

  /Gretina/detector/enableCapsules
  /Gretina/detector/enableCryostats
  /Gretina/Shell full/north/south

Mandatory command after setting any GRETINA parameters:

  /Gretina/update

To produce output ready for conversion to Mode 2 data:

  /Mode2/crmatFile <filename>

    The file "crmat.txt" is provided with this tarball. It specifies
    the rotation matrices and translation vectors from each crystal
    frame into the world coordinate system. UCGretina inverts this
    transformation to produce data in the crystal frames, as expected
    in Mode 2 data. 

  /Mode2/GretinaCoords

    When this command is present, the world coordinates are 
    rotated Pi/2 about z to match the standard GRETINA coordinate
    system (x = down, z = beam). This is the coordinate system
    expected in Mode 2 data.

    Interaction points are expressed in the Geant4 coordinate system
    (y = up, z = beam) by default.

  /Mode2/PositionRes <float> <unit>

    The PositionRes parameter determines the closest spacing of
    gamma-ray interaction points within each event that GRETINA can
    resolve. Specify a zero position resolution to turn off
    consolidation.

================================================================================
To visualize the array

  Run the macro file "vis.mac" an interactive session:

  $ UCGretina

  Idle> /control/execute vis/vis.mac
  Idle> exit

This generates a VRML 2 file named g4_XX.wrl which can be viewed with
a VRML viewer (like mayavi2).

================================================================================

To simulate, sort, and fit in-beam gamma-ray spectra, see the fit and
fitLH subdirectories.

================================================================================

To simulate calibration source measurements and compare them with
measurements, see the eu152 subdirectory.

================================================================================